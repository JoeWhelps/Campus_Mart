<!-- messaging/templates/messaging/inbox.html -->

{% extends "core/base.html" %}

{% block content %}
<h1>Inbox</h1>

<h2>Received Messages</h2>
<ul>
    {% for message in received_messages %}
        <li>
            <a href="{% url 'messaging:message_detail' message.id %}">
                From: {{ message.sender.username }} - {{ message.content|truncatewords:5 }}
                <small>({{ message.timestamp|date:"M d, Y H:i" }})</small>
            </a>
        </li>
    {% empty %}
        <li>No messages received yet.</li>
    {% endfor %}
</ul>

<h2>Sent Messages</h2>
<ul>
    {% for message in sent_messages %}
        <li>
            <a href="{% url 'messaging:message_detail' message.id %}">
                To: {{ message.receiver.username }} - {{ message.content|truncatewords:5 }}
                <small>({{ message.timestamp|date:"M d, Y H:i" }})</small>
            </a>
        </li>
    {% empty %}
        <li>No messages sent yet.</li>
    {% endfor %}
</ul>

<h2>Send a New Message</h2>
<div class="user-list">
    <h3>Select a recipient:</h3>
    <ul>
        {% for user in all_users %}
            <li>
                <a href="{% url 'messaging:send_message' recipient_id=user.id %}">
                    Send message to {{ user.username }}
                </a>
            </li>
        {% empty %}
            <li>No other users available.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}

